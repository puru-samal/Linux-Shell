# Linux Shell

My implementation of a simple Linux shell, an interactive command-line interpreter that runs programs on behalf of the user with job control and I/0 redirection. The shell prints a prompt, waits for a command and then carries out some action based on some command. Commands fall into two broad categories:

-   not Built-in commands: These are paths to executable files that the shell runs in a child process within the shell so as to not corrupt the state of its own process. Child processes created as a result of interpreting such a command are referred to as jobs. The shell waits for forground jobs to terminate before resuming execution while the shell does not wait for the background job to terminate before resuming execution. If a command ends with an '&' then the shell runs the job in the background. Otherwise it is run in the foreground.
-   Built-in commands: These commands run within the shell's process. The build-in commands supported by this shell are:

               quit - Terminates the shell
               jobs - Lists all background jobs
               bg (%)job - Resumes a job by sending it a SIGCONT signal then
                           runs it in background.
               fg (%)job - Resumes a job by sending it a SIGCONT signal then
                           runs it in foreground.

    For the bg/fg commands the job argument can either be a process ID or job ID. Prepending the argument with '%' ensures that the argument is interpreted to be a job ID.

The shell manages 3 signals, namely:

-   SIGINT- Recieved by CTRL-C
-   SIGSTP - Recieved bt CTRL-Z
-   SIGCHLD - Recieved when a child process stops/terminates.

The shell also supports I/O redirection. The output of a non-build-in command can be redirected from stdout to another location (eg. a file) using `>`. Similarly, the input source can be redirected from `STDIN` from another location using `<`. For builtin commands, This shell only supports output redirection for the build-in command `jobs`.
Tested on `64-bit Ubuntu 22.04.1 LTS (Linux kernel 5.15.0)`.

# Usage

Compile with `make`. Run with `./tsh`

# Project Structure

-   `tsh.c` : The main implementation file.
-   `tsh_helper.{c,h}` : Implements some of the utility routines that manipulate a job list, and a command line parser.
-   `csapp.{c,h}` : Utility files used in CS:APP textbook. These included wrapped
    versions of a number of system functions, plus the SIO safe I/O library
-   `tshref\*` : A reference shell executable
-   `sdriver.c` : The shell driver source program
-   `runtrace.c` : The trace interpreter source program
-   `trace{00-29}.txt` : Trace files used by the driver
-   `config.h` : Header file for sdriver.c
-   `wrapper.c` : Utility file used to make races more likely
-   `testprogs\*` : These are helper programs that are referenced in the trace files.
-   `Makefile` : This is the makefile that builds the driver program.

# Test Output

Run all traces with `./sdriver`.

```
./sdriver -A
Running 3 iters of 'traces/trace00.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace01.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace02.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace03.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace04.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace05.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace06.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace07.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace08.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace09.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace11.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace12.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace13.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace14.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace15.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace16.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace17.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace18.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace19.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace20.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace21.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace22.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace23.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace24.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace25.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace26.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace27.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace28.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace29.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace30.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace31.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...
Running 3 iters of 'traces/trace32.txt'
Iteration 1/3...
Iteration 2/3...
Iteration 3/3...

Summary: 32/32 correct traces

```
